{
	"$schema": "http://json-schema.org/draft-07/schema#",
	"$id": "https://fmgarage.com/schema/fxrp-xl-v2-2-0.json",
	"title": "FX Reports Template Editor",
	"description": "Generating xlsx spreadsheets from a json definition",
	"$comment": "https://json-schema.org/understanding-json-schema/index.html",
	"type": "object",
	"properties": {
		"$comment": {
			"title": "Internal Comment",
			"type": "string"
		},
		"schemaVersion": {
			"type": "string",
			"title": "Schema Version",
			"description": "Specify a minimum Schema Version",
			"minLength": 1,
			"pattern": "^\\d{1,3}(\\.\\d{1,3}(\\.\\d{1,3})?)?$"
		},
		"filename": {
			"title": "Target Filename",
			"description": "Name of the generated file, placeholders are supported",
			"type": "string",
			"default": "Export.xslx"
		},
		"location": {
			"title": "Target Location",
			"description": "folder path ('desktop/exports') or field reference (e.g. FxReports::a_tmp_[1])",
			"default": "FxReports::a_tmp_[1]",
			"type": "string"
		},
		"formats": {
			"type": "object",
			"title": "Definitions: Formats",
			"description": "Add named formats that can be referenced in columns, rows and cells",
			"additionalProperties": {
				"$ref": "#/definitions/format"
			}
		},
		"fonts": {
			"type": "object",
			"title": "Definitions: Fonts",
			"description": "Add Font definitions by specifying a unique Name.",
			"additionalProperties": {
				"$ref": "#/definitions/font"
			}
		},
		"colors": {
			"type": "object",
			"title": "Definitions: Colors",
			"description": "",
			"additionalProperties": {
				"type": "object",
				"anyOf": [
					{
						"title": "as name",
						"properties": {
							"name": {"$ref": "#/definitions/colorName"}
						},
						"required": ["name"],
						"additionalProperties": false
					},
					{
						"title": "as RGB",
						"properties": {
							"rgb": {"$ref": "#/definitions/colorRgb"}
						},
						"required": ["rgb"],
						"additionalProperties": false
					}
				]
			}
		},
		"pictures": {
			"type": "object",
			"title": "Definitions: Pictures",
			"description": "picture name as ref and path as field reference or file path",
			"additionalProperties": {
				"title": "picture catalog item",
				"description": "add picture to catalog by path or as base64",
				"type": "object",
				"anyOf": [
					{
						"title": "as path",
						"properties": {
							"path": {
								"type": "string",
								"format": "uri-reference",
								"title": "path to image file",
								"description": "system path, shortcuts are supported (e.g. 'desktop/logo.jpeg')"
							}
						},
						"required": ["path"],
						"additionalProperties": false
					},
					{
						"title": "as base64",
						"properties": {
							"base64": {
								"type": "string",
								"title": "base64 encoded",
								"contentEncoding": "base64",
								"contentMediaType": "image/png"
							}
						},
						"required": ["base64"],
						"additionalProperties": false
					}
				]
			}
		},
		"formatRef": {
			"title": "Default Format Reference",
			"description": "Will be applied to the Document",
			"$ref": "#/definitions/formatRef"
		},
		"format": {
			"title": "Default Format Options",
			"description": "Will be applied to the Document",
			"$ref": "#/definitions/format"
		},
		"display": {
			"title": "Default Display Options",
			"description": "Will be applied to the Document",
			"$ref": "#/definitions/display"
		},
		"print": {
			"title": "Default Print Options",
			"$ref": "#/definitions/print"
		},
		"columnWidth": {
			"title": "Default Column Width",
			"description": "Set default Column Width for all Sheets, use -1 for 'auto'",
			"$ref": "#/definitions/columnWidth"
		},
		"columns": {
			"title": "Columns",
			"$ref": "#/definitions/columns"
		},
		"rows": {
			"title": "Rows",
			"$ref": "#/definitions/rows"
		},
		"cells": {
			"title": "Cells",
			"$ref": "#/definitions/cells"
		},
		"name": {
			"title": "Sheet Name",
			"$ref": "#/definitions/sheetName"
		},
		"split": {
			"title": "Sheet Split",
			"$ref": "#/definitions/split"
		},
		"sheets": {
			"title": "Multiple Sheets",
			"$ref": "#/definitions/sheets"
		}
	},
	"additionalProperties": false,
	"definitions": {
		"border": {
			"title": "Border style",
			"description": "",
			"anyOf": [
				{
					"title": "by ID",
					"type": "integer",
					"minimum": 0,
					"maximum": 13,
					"enum": [0,1,2,3,4,5,6,7,8,9,10,11,12,13],
					"default": 1
				},
				{
					"title": "by Name",
					"type": "string",
					"enum": ["none", "thin", "medium", "dashed", "dotted", "thick", "double", "hair", "medium dashed", "dash dot", "medium dash dot", "dash dot dot", "medium dash dot dot", "slant dash dot"],
					"default": "thin"
				}
			]
		},
		"case": {
			"title": "Case-Statement",
			"description": "conditional cell properties",
			"anyOf": [
				{"$ref": "#/definitions/caseObject"},
				{
					"title": "multiple conditions OR",
					"type": "array",
					"minItems": 1,
					"items": {"$ref": "#/definitions/caseObject"}
				}
			]
		},
		"caseObject": {
			"type": "object",
			"title": "Condition",
			"properties": {
				"if": {
					"$ref": "#/definitions/if"
				},
				"then": {
					"$ref": "#/definitions/thenOrElse"
				},
				"else": {
					"$ref": "#/definitions/thenOrElse"
				},
				"note": { 
					"title": "internal note",
					"$ref": "#/definitions/note" 
				}
			},
			"required": ["if", "then"],
			"additionalProperties": false
		},
		"cell": {
			"type": "object",
			"properties": {
				"pos": {
					"title": "Cell Position",
					"description": "",
					"type": "array",
					"items": [{
							"type": "integer",
							"title": "x",
							"minimum": 0
						},
						{
							"type": "integer",
							"title": "y",
							"minimum": 0
						},
						{
							"type": "integer",
							"title": "length x",
							"minimum": -1
						},
						{
							"type": "integer",
							"title": "length y",
							"minimum": -1
						}
					],
					"minItems": 2,
					"maxItems": 4,
					"$comment": "col, row, col-length, row-length -- default length is 1"
				},
				"formatRef": {
					"$ref": "#/definitions/formatRef"
				},
				"format": {
					"$ref": "#/definitions/format"
				},
				"value": {
					"$ref": "#/definitions/value"
				},
				"height": {
					"title": "Cell Height",
					"description": "",
					"type": "integer"
				},
				"width": {
					"title": "Cell Width",
					"description": "",
					"type": "integer"
				},
				"picture": {
					"$ref": "#/definitions/picture"
				},
				"case": {
					"$ref": "#/definitions/case"
				},
				"note": { 
					"title": "internal note",
					"$ref": "#/definitions/note" 
				}
			},
			"additionalProperties": false,
			"required": ["pos"]
		},
		"cells": {
			"type": "array",
			"minItems": 1,
			"items": {
				"$ref": "#/definitions/cell"
			}
		},
		"color":{
			"type": "object",
			"title": "color object",
			"description": "contains color as name, ref or rgb",
			"oneOf": [
				{
					"title": "by name",
					"properties": {
						"name": {
							"$ref": "#/definitions/colorName"
						}
					},
					"required": ["name"],
					"additionalProperties": false
				},
				{
					"title": "by reference",
					"properties": {
						"ref": {
							"$ref": "#/definitions/colorRef"
						}
					},
					"required": ["ref"],
					"additionalProperties": false
				},
				{
					"title": "by RGB values",
					"properties": {
						"rgb": {
							"$ref": "#/definitions/colorRgb"
						}
					},
					"required": ["rgb"],
					"additionalProperties": false
				}
			]
		},
		"colorName": {
			"type": "string",
			"title": "Color Name",
			"description": "Excel's predifined Colors",
			"enum": ["none", "black", "white", "red", "brightgreen", "blue", "yellow", "pink", "turquoise", "darkred", "green", "darkblue", "darkyellow", "violet", "teal", "gray25", "gray50", "periwinkle cf", "plum cf", "ivory cf", "lightturquoise cf", "darkpurple cf", "coral cf", "oceanblue cf", "iceblue cf", "darkblue cl", "pink cl", "yellow cl", "turquoise cl", "violet cl", "darkred cl", "teal cl", "blue cl", "skyblue", "lightturquoise", "lightgreen", "lightyellow", "paleblue", "rose", "lavender", "tan", "lightblue", "aqua", "lime", "gold", "lightorange", "orange", "bluegray", "gray40", "darkteal", "seagreen", "darkgreen", "olivegreen", "brown", "plum", "indigo", "gray80", "default foreground", "default background", "tooltip", "auto", "Black", "White", "Red", "Brightgreen", "Blue", "Yellow", "Pink", "Turquoise", "Darkred", "Green", "Darkblue", "Darkyellow", "Violet", "Teal", "Gray25", "Gray50", "Periwinkle Cf", "Plum Cf", "Ivory Cf", "Lightturquoise Cf", "Darkpurple Cf", "Coral Cf", "Oceanblue Cf", "Iceblue Cf", "Darkblue Cl", "Pink Cl", "Yellow Cl", "Turquoise Cl", "Violet Cl", "Darkred Cl", "Teal Cl", "Blue Cl", "Skyblue", "Lightturquoise", "Lightgreen", "Lightyellow", "Paleblue", "Rose", "Lavender", "Tan", "Lightblue", "Aqua", "Lime", "Gold", "Lightorange", "Orange", "Bluegray", "Gray40", "Darkteal", "Seagreen", "Darkgreen", "Olivegreen", "Brown", "Plum", "Indigo", "Gray80", "Default Foreground", "Default Background", "Tooltip", "Auto"]
		},
		"colorRef": {
			"type": "string",
			"title": "Color Reference",
			"description": "Name of Color Definition, must be defined in /colors",
			"pattern": "^[a-zA-Z0-9-_]{2,}",
			"default": ""
		},
		"colorRgb": {
			"type": "array",
			"title": "Color RGB",
			"description": "RGB values 0-255",
			"minItems": 3,
			"maxItems": 3,
			"items": [
				{
					"title": "Red",
					"type": "integer",
					"minimum": 0,
					"maximum": 255,
					"default": 255
				},
				{
					"title": "Green",
					"type": "integer",
					"minimum": 0,
					"maximum": 255,
					"default": 255
				},
				{
					"title": "Blue",
					"type": "integer",
					"minimum": 0,
					"maximum": 255,
					"default": 255
				}
			]
		},
		"column": {
			"title": "Column",
			"type": "object",
			"properties": {
				"pos": {
					"title": "Column Position",
					"description": "Either Position or Range",
					"anyOf": [{
							"type": "integer",
							"minimum": -1
						},
						{
							"type": "array",
							"$comment": "start index, length. -1 or undefined for auto.",
							"minItems": 1,
							"maxItems": 2,
							"items": {
								"type": "integer",
								"minimum": -1
							}
						}
					]
				},
				"type": {
					"type": "string",
					"enum": ["header", "data", "summary"]
				},
				"width": {
					"$ref": "#/definitions/columnWidth"
				},
				"formatRef": {
					"$ref": "#/definitions/formatRef"
				},
				"format": {
					"$ref": "#/definitions/format"
				},
				"dataType": {
					"$ref": "#/definitions/dataType"
				},
				"dataOnly": {
					"title": "Data Only",
					"description": "",
					"type": "boolean",
					"default": true
				},
				"case": {
					"title": "Case-Statement",
					"$ref": "#/definitions/case"
				}
			},
			"additionalProperties": false
		},
		"columnWidth": {
			"title": "Default Column Width",
			"description": "Set default Column Width for all Sheets",
			"type": "integer",
			"minimum": -1,
			"default": -1
		},
		"columns": {
			"title": "Columns",
			"type": "array",
			"minItems": 1,
			"items": {
				"title": "Column",
				"$ref": "#/definitions/column"
			}
		},
		"dataType": {
			"title": "Data Type",
			"type": "string",
			"enum": ["text", "number", "date", "timestamp"]
		},
		"dateFormat": {},
		"display": {
			"title": "Display Options",
			"type": "object",
			"$comment": "can be applied to book or sheet",
			"properties": {
				"hideGrid": {
					"title": "Hide Grid",
					"type": "boolean",
					"default": true
				},
				"zoom": {
					"title": "Zoom",
					"type": "integer",
					"minimum": 25,
					"maximum": 400,
					"default": 150
				}
			},
			"additionalProperties": false
		},
		"font": {
			"type": "object",
			"description": "Font Definition",
			"properties": {
				"fontRef": {
					"title": "Font Reference",
					"$ref": "#/definitions/fontRef"
				},
				"fontColor": {
					"title": "Font Color",
					"$ref": "#/definitions/color"
				},
				"fontName": {
					"type": "string",
					"title": "Font Name",
					"description": "Font face (e.g. 'Helvetica'"
				},
				"fontSize": {
					"type": "integer",
					"minimum": 1,
					"title": "Font Size",
					"desciption": ""
				},
				"bold": {
					"title": "Bold",
					"type": "boolean"
				},
				"note": { 
					"title": "internal note",
					"$ref": "#/definitions/note" 
				}
			},
			"additionalProperties": false
		},
		"fontRef": {
			"type": "string",
			"title": "Font Reference",
			"description": "Name of a Font Definition"
		},
		"format": {
			"type": "object",
			"description": "",
			"properties": {
				"formatRef": {
					"title": "Format Reference",
					"description": "Use an existing Format Definition to apply Changes to.",
					"$ref": "#/definitions/formatRef"
				},
				"dataType": {
					"title": "Cell Data Type",
					"type": "string",
					"description": "Data Type of the Excel Cell",
					"enum": ["string", "number", "date", "blank", "timestamp", "formula"]
				},
				"lock": {
					"title": "Cell Lock",
					"type": "boolean"
				},
				"hide": {
					"title": "Cell Hide",
					"type": "boolean"
				},
				"shrinkToFit": {
					"title": "Cell Shrink to Fit",
					"type": "boolean"
				},
				"fontRef": {
					"title": "Font Reference",
					"$ref": "#/definitions/fontRef"
				},
				"fontName": {
					"title": "Font Name",
					"description": "Font face name (e.g. 'Helvetica')",
					"type": "string"
				},
				"fontSize": {
					"title": "Font Size",
					"desciption": "Font Size in pt",
					"type": "integer",
					"minimum": 1
				},
				"fontColor": {
					"title": "Font Color",
					"$ref": "#/definitions/color"
				},
				"bold": {
					"title": "Text is Bold",
					"type": "boolean"
				},
				"italic": {
					"title": "Text is Italic",
					"type": "boolean"
				},
				"underline": {
					"title": "Text Underline",
					"type": "string",
					"enum": ["single", "double", "acc single", "acc double"]
				},
				"alignH": {
					"title": "Text Horizontal Alignment",
					"description": "Alignment of Text in Cell: 0 general, 1 left, 2 center, 3 right, 4 full, 5 justify, 6 merge, 7 distributed",
					"$comment": "general, left, center, right, full, justify, merge, distributed",
					"type": "integer",
					"enum": [0, 1, 2, 3, 4, 5, 6, 7],
					"minimum": 1,
					"maxValue": 7
				},
				"alignV": {
					"title": "Text Vertical Alignment",
					"description": "Alignment of Text in Cell",
					"type": "integer",
					"minimum": 1,
					"$comment": "top, center, bottom, justify, distributed"
				},
				"wrap": {
					"title": "Text Wrap",
					"type": "boolean",
					"description": ""
				},
				"indent": {
					"title": "Text Indent",
					"type": "integer"
				},
				"rotate": {
					"title": "Text Rotate",
					"type": "integer",
					"description": "Rotate Text by value from 0 to 255",
					"minimum": 0,
					"maximum": 255
				},
				"numberFormat": {
					"title": "Number Format Reference",
					"$ref": "#/definitions/numberFormat"
				},
				"numberFormatCustom": {
					"$ref": "#/definitions/numberFormatCustom"
				},
				"border": {
					"title": "Border: Style",
					"description": "set the style for all 4 borders",
					"$ref": "#/definitions/border"
				},
				"borderColor": {
					"title": "Border: Color",
					"$ref": "#/definitions/color"
				},
				"borderTop": {
					"title": "Border Top: Style",
					"$ref": "#/definitions/border"
				},
				"borderTopColor": {
					"title": "Border Top: Color",
					"$ref": "#/definitions/color"
				},
				"borderRight": {
					"title": "Border Right: Style",
					"$ref": "#/definitions/border"
				},
				"borderRightColor": {
					"title": "Border Right: Color",
					"$ref": "#/definitions/color"
				},
				"borderBottom": {
					"title": "Border Bottom: Style",
					"$ref": "#/definitions/border"
				},
				"borderBottomColor": {
					"title": "Border Bottom: Color",
					"$ref": "#/definitions/color"
				},
				"borderLeft": {
					"title": "Border Left: Style",
					"$ref": "#/definitions/border"
				},
				"borderLeftColor": {
					"title": "Border Left: Color",
					"$ref": "#/definitions/color"
				},
				"borderDiagonal": {
					"title": "Border Diagonal: Style",
					"$ref": "#/definitions/border"
				},
				"borderDiagonalMode": {
					"title": "Border Diagonal: Mode",
					"type": "string",
					"enum": ["none", "up", "down", "both"]
				},
				"borderDiagonalColor": {
					"title": "Border Diagonal: Color",
					"$ref": "#/definitions/color"
				},
				"pattern": {
					"title": "Background Pattern",
					"anyOf": [{
							"type": "string",
							"enum": ["none", "solid", "50% gray", "75% gray", "25% gray", "horizontal stripes", "vertical stripes", "reverse diagonal stripes", "diagonal stripes", "diagonal cross hatch", "thick diagonal stripe", "thin horizontal stripe", "thin vertical stripe", "thin reverse diagonal stripe", "thin diagonal stripe", "thin horizontal cross hatch", "thin diagonal cross hatch", "gray 12p5", "gray 6p25"]
						},
						{
							"type": "integer",
							"minimum": 0,
							"maximum": 18,
							"$comment": "see: https://www.mbsplugins.eu/XLFormatSetFillPattern.shtml"
						}
					],
					"$comment": "see: https://www.mbsplugins.eu/XLFormatSetFillPattern.shtml"
				},
				"backgroundColor": {
					"title": "Background Color",
					"$ref": "#/definitions/color"
				},
				"foregroundColor": {
					"title": "Foreground Color",
					"$ref": "#/definitions/color"
				},
				"note": { 
					"title": "internal note",
					"$ref": "#/definitions/note" 
				}
			},
			"additionalProperties": false
		},
		"formatRef": {
			"type": "string",
			"title": "Format Reference",
			"description": "Name of a defined Format"
		},
		"if": {
			"type": "object",
			"title": "condition",
			"$comment": "{'if':{'value':{'beginsWith':'a'}}}",
			"properties": {
				"value": {
					"type": "object",
					"title": "Value",
					"description": "Caution: specify only *one* operator.",
					"properties": {
						"equalTo": {
							"type": ["string", "number"]
						},
						"beginsWith": {
							"type": "string"
						},
						"endsWith": {
							"type": "string"
						},
						"contains": {
							"type": "string"
						},
						"containsAny": {
							"type": "array",
							"items": {
								"type": "string"
							}
						},
						"containsAll": {
							"type": "array",
							"items": {
								"type": "string"
							}
						},
						"greaterThan": {
							"type": "number"
						},
						"greaterThanOrEqualTo": {
							"type": "number"
						},
						"lessThan": {
							"type": "number"
						},
						"lessThanOrEqualTo": {
							"type": "number"
						}
					},
					"additionalProperties": false
				}
			},
			"required": ["value"],
			"additionalProperties": false
		},
		"note": {
			"title": "internal note",
			"type": "string"
		},
		"numberFormat": {
			"title": "Number Format",
			"description": "invidiual format options for numbers, dates, currencies\rsee https://www.mbsplugins.eu/XLFormatSetNumFormat.shtml",
			"anyOf": [
				{
					"type": "string",
					"enum": ["general", "number", "number_d2"],
					"$comment": "@todo: parametrisieren, url: https://www.mbsplugins.eu/XLFormatSetNumFormat.shtml"
				},
				{
					"type": "integer",
					"minimum": 0,
					"maxValue": 49
				}
			]
		},
		"numberFormatCustom": {
			"title": "Custom Number Format",
			"description": "custom format options for numbers, dates, currencies..., check https://www.libxl.com/custom-format.html",
			"type": "string"
		},
		"picture": {
			"type": "object",
			"title": "Picture",
			"anyOf": [
				{
					"title": "as reference",
					"properties": {
						"ref": {
							"title": "reference",
							"description": "named picture from catalog",
							"type": "string"
						},
						"width": {
							"$ref": "#/definitions/pictureWidth"
						},
						"height": {"$ref": "#/definitions/pictureHeight" },
						"scale": {"$ref": "#/definitions/pictureScale" },
						"x": {"$ref": "#/definitions/pictureX" },
						"y": {"$ref": "#/definitions/pictureY" },
						"position": {"$ref": "#/definitions/picturePosition" },
						"note": {
							"title": "internal note",
							"$ref": "#/definitions/note"
						}
					},
					"additionalProperties": false,
					"required": ["ref"]
				},
				{
					"title": "as path",
					"properties": {
						"path": {
							"type": "string",
							"format": "uri-reference",
							"title": "path to image file",
							"description": "system path, shortcuts are supported (e.g. 'desktop/logo.jpeg')"
						},
						"width": {"$ref": "#/definitions/pictureWidth" },
						"height": {"$ref": "#/definitions/pictureHeight" },
						"scale": {"$ref": "#/definitions/pictureScale" },
						"x": {"$ref": "#/definitions/pictureX" },
						"y": {"$ref": "#/definitions/pictureY" },
						"position": {"$ref": "#/definitions/picturePosition" },
						"note": {
							"title": "internal note",
							"$ref": "#/definitions/note" 
						}
					},
					"additionalProperties": false,
					"required": ["path"]
				},
				{
					"title": "as base64",
					"properties": {
						"base64": {
							"type": "string",
							"contentEncoding": "base64",
							"contentMediaType": "image/png"
						},
						"width": {"$ref": "#/definitions/pictureWidth" },
						"height": {"$ref": "#/definitions/pictureHeight" },
						"scale": {"$ref": "#/definitions/pictureScale" },
						"x": {"$ref": "#/definitions/pictureX" },
						"y": {"$ref": "#/definitions/pictureY" },
						"position": {"$ref": "#/definitions/picturePosition" },
						"note": {
							"title": "internal note",
							"$ref": "#/definitions/note" 
						}
					},
					"additionalProperties": false,
					"required": ["base64"]
				}
			]
		},
		"pictureWidth": {
			"type": "integer",
			"title": "image width",
			"description": "pixels, can be -1 or non-defined for auto"
		},
		"pictureHeight": {
			"type": "integer",
			"title": "image height",
			"description": "pixels, can be -1 or non-defined for auto"
		},
		"pictureScale": {
			"title": "Scale factor of picture",
			"description": "You can either use scale or width and height. Default ist 1.0",
			"type": "number",
			"exclusiveMinimum": 0,
			"maximum": 1
		},
		"pictureX": {
			"type": "integer",
			"title": "Relative offset from left in pixels"
		},
		"pictureY": {
			"type": "integer",
			"title": "relative offset from top in pixels"
		},
		"picturePosition": {
			"type": "string",
			"titel": "positioning of the image",
			"enum": ["resize", "move", "fix"],
			"description": "resize: move&resize, move: only move, fix: position is absolute"
		},
		"print": {
			"title": "Default Print Options",
			"description": "Will be applied to the Document",
			"type": "object",
			"$comment": "can be applied to book or sheet",
			"properties": {
				"landscape": {
					"type": "boolean"
				},
				"headerText": {
					"type": "string",
					"example": "Meine Auswertung"
				},
				"headerMargin": {
					"type": "number",
					"$comment": "default = 0"
				},
				"withGrid": {
					"type": "boolean"
				},
				"fit": {
					"type": "array",
					"minItems": 1,
					"maxItems": 2,
					"contains": {
						"type": "integer",
						"minimum": 0
					}
				},
				"note": { 
					"title": "internal note",
					"$ref": "#/definitions/note" 
				}
			}
		},
		"row": {
			"type": "object",
			"title": "Row",
			"description": "Row is added after the previous one if not defined otherwise using 'Position'",
			"properties": {
				"type": {
					"type": "string",
					"title": "Row Type",
					"description": "Rows can be of type 'header', 'data' or 'summary'",
					"enum": ["header", "data", "summary"]
				},
				"dataType": {"$ref": "#/definitions/dataType"},
				"pos": {
					"title": "Position",
					"description": "Absolute Position (integer) or Position and Length (array)",
					"anyOf": [{
							"type": "integer",
							"$comment": "Position of row. First column has pos 0",
							"minimum": 0
						},
						{
							"type": "array",
							"$comment": "optional column offset",
							"minItems": 2,
							"maxItems": 2,
							"items": {
								"type": "integer",
								"minimum": 0
							}
						}
					]
				},
				"formatRef": {
					"title": "Format Reference",
					"$ref": "#/definitions/formatRef"
				},
				"format": {
					"title": "Format Details",
					"description": "Define a format from scratch or modify a referenced format",
					"$ref": "#/definitions/format"
				},
				"includeFirstRow": {
					"title": "Include first row",
					"description": "Include the first row of the source file, normally contains columns headers",
					"type": "boolean",
					"default": true
				},
				"values": {
					"title": "Values",
					"description": "Add one row (array of values) or multiple rows (array of arrays)",
					"type": "array",
					"minItems": 1,
					"anyOf": [
						{
							"title": "as single row",
							"items": {
								"$ref": "#/definitions/value"
							}
						},
						{
							"title": "as multiple rows",
							"items": {
								"type": "array",
								"items": {
									"$ref": "#/definitions/value"
								}
							}
						}
					]
				},
				"path": {
					"title": "Data Source Path",
					"description": "File path or field name",
					"type": "string",
					"$comment": "include path for data file",
					"default": "FxReports::a_container_[2]"
				},
				"limit": {
					"title": "Data Source Limit",
					"description": "Limit Rows from Data Source",
					"type": "integer",
					"minimum": 0
				},
				"offset": {
					"title": "Data Source Offset",
					"description": "Specify Data File Row to begin with",
					"type": "integer",
					"minimum": 0
				},
				"contentType": {
					"title": "Data Source Type",
					"description": "Content Type in Source File or Field",
					"type": "string",
					"enum": ["json", "csv", "tab"],
					"default": "json"
				},
				"fields": {
					"title": "Data Source Filter",
					"description": "Filter Data Source by Column Names",
					"type": "array",
					"items": {
						"type": "string"
					},
					"minItems": 1
				},
				"height": {
					"title": "Row Height",
					"description": "Set the Row Height",
					"type": "integer"
				},
				"widths": {
					"title": "Column Widths",
					"description": "Specify Columns Widths, use -1 for 'auto'. To specify the width for all columns, set Default Column Width in sheet or workbook",
					"type": "array",
					"minItems": 1,
					"items": {
						"type": "integer",
						"minimum": -1,
						"default": -1
					}
				},
				"note": { 
					"title": "internal note",
					"$ref": "#/definitions/note" 
				}
			},
			"additionalProperties": false
		},
		"rows": {
			"title": "Rows ",
			"description": "Array of Rows, starting from top if not specified by Position.\rData Rows are repeated regarding to their input.",
			"type": "array",
			"minItems": 1,
			"items": {
				"$ref": "#/definitions/row"
			}
		},
		"sheet": {
			"title": "Sheet",
			"description": "Content and Structure of an Excel Sheet. 'Columns', 'Rows' and 'Cells' will be processed in this very order",
			"type": "object",
			"properties": {
				"name": {
					"title": "Sheet Name",
					"$ref": "#/definitions/sheetName"
				},
				"formatRef": {
					"title": "Default Format Reference",
					"description": "Set Default Format for Sheet",
					"$ref": "#/definitions/formatRef"
				},
				"format": {
					"title": "Format Details",
					"$ref": "#/definitions/format"
				},
				"display": {
					"title": "Display Options",
					"$ref": "#/definitions/display"
				},
				"print": {
					"title": "Print Options",
					"$ref": "#/definitions/print"
				},
				"split": {
					"title": "Sheet split",
					"description": "Split Sheet at 0:1 (boolean) or individual x:y location (array)",
					"$ref": "#/definitions/split"
				},
				"columnWidth": {
					"title": "Default Column Width",
					"description": "Set the default width for all columns in the worksheet, use -1 for auto",
					"$ref": "#/definitions/columnWidth"
				},
				"columns": {
					"title": "Columns",
					"$ref": "#/definitions/columns"
				},
				"rows": {
					"title": "Rows",
					"$ref": "#/definitions/rows"
				},
				"cells": {
					"title": "Cells",
					"$ref": "#/definitions/cells"
				},
				"filters": {
					"type": "object",
					"additionalProperties": {
						"type": "object",
						"properties": {}
					}
				},
				"defaultColumn": {
					"type": "object",
					"properties": {
						"width": {
							"type": "integer",
							"minimum": -1
						},
						"minWidth": {
							"type": "integer",
							"minimum": 1
						},
						"maxWidth": {
							"type": "integer",
							"minimum": 1
						}
					},
					"additionalProperties": false
				},
				"note": { 
					"title": "internal note",
					"$ref": "#/definitions/note" 
				}
			},
			"additionalProperties": false
		},
		"sheetName": {
			"type": "string",
			"title": "Sheet Name",
			"description": "Optional sheet name",
			"default": "Sheet1"
		},
		"sheets": {
			"type": "array",
			"title": "Multiple Sheets",
			"description": "This array can be used if more than one sheet is defined",
			"minItems": 1,
			"items": {
				"$ref": "#/definitions/sheet"
			}
		},
		"split": {
			"title": "Sheet Split",
			"description": "Split Sheet at 0:1 (boolean) or individual x:y location (array)",
			"anyOf": [{
					"type": "boolean",
					"description": "true for default split at 0|1"
				},
				{
					"type": "array",
					"maxItems": 2,
					"description": "empty for default, col/row",
					"items": {
						"type": "integer"
					}
				}
			]
		},
		"thenOrElse": {
			"type": "object",
			"properties": {
				"formatRef": {
					"title": "Format Reference",
					"$ref": "#/definitions/formatRef"
				},
				"picture": {
					"title": "Picture",
					"$ref": "#/definitions/picture"
				},
				"value": {
					"title": "Value",
					"type": ["string", "number", "null"]
				}
			},
			"additionalProperties": false
		},
		"value": {
			"type": ["string", "number", "boolean", "null"],
			"default": ""
		}
	}
}
