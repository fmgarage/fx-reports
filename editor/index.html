<!--
The MIT License (MIT)

Copyright (c) 2013 Jeremy Dorn

Permission is hereby granted, free of charge, to any person obtaining a copy of
this software and associated documentation files (the "Software"), to deal in
the Software without restriction, including without limitation the rights to
use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of
the Software, and to permit persons to whom the Software is furnished to do so,
subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

https://json-editor.github.io/json-editor/
https://github.com/json-editor/json-editor

-->

<html lang="en">
<script type="text/javascript">window["_gaUserPrefs"] = { ioo: function () { return true; } }</script>

<head>
    <meta charset="utf-8">
    <title>JSON Editor Interactive Example</title>

    <!-- https://cdn.jsdelivr.net/npm/@json-editor/json-editor@latest/dist/jsoneditor.min.js -->
    <script type="text/javascript" src="assets/json-editor-261.js"></script>
    <script type="text/javascript" src="assets/lzstring-144.js"></script>
    <link rel="stylesheet" id="theme-link" href="assets/bootstrap.min.css">
    <link rel="stylesheet" id="iconlib-link" href="assets/all.css">
    <style id="theme-default"></style>
    <style id="theme-bootstrap4"></style>
    <link rel="stylesheet" id="iconlib-link" href="assets/fmg-additional.css">
    <style>
        tcxspan {
            text-decoration: underline;
            cursor: pointer;
        }
    </style>
</head>

<body>
    <div class="container grid-xl">
        <div class="row columns md:flex">
            <div class="col-8 col-md-8 w-8/12">
                <div id="json-editor-form" data-theme="bootstrap4">
                </div>
            </div>
            <div class="col-4 col-md-4 w-4/12">
                <label for="output-textarea"></label>
                <button class="btn btn-primary btn-block" id="setvalue">Update Form</button>
                <textarea id="output-textarea" rows="15" style="width: 100%; font-family: monospace;"
                class="form-control"></textarea>
                <br>
                <div style="display: none;">
                    <label for="boolean-options-select">Boolean options</label><br>
                    <select multiple="" size="15" id="boolean-options-select" class="form-control browser-default"
                        data-enpassusermodified="yes">
                        <option value="required_by_default">Object properties required by default</option>
                        <option value="display_required_only">Only show required properties by default</option>
                        <option value="show_opt_in">Show optional properties (with checkbox)</option>
                        <option value="no_additional_properties">No additional object properties</option>
                        <option value="ajax">Allow loading schemas via Ajax</option>
                        <option value="disable_edit_json">Disable "Edit JSON" buttons</option>
                        <option value="disable_collapse">Disable collapse buttons</option>
                        <option value="disable_properties">Disable properties buttons</option>
                        <option value="disable_array_add">Disable array add buttons</option>
                        <option value="disable_array_reorder">Disable array move buttons</option>
                        <option value="disable_array_delete">Disable array delete buttons</option>
                        <option value="enable_array_copy">Add copy buttons to arrays</option>
                        <option value="array_controls_top">Array controls will be displayed at top of list</option>
                        <option value="disable_array_delete_all_rows">Disable array delete all rows buttons</option>
                        <option value="disable_array_delete_last_row">Disable array delete last row buttons</option>
                    </select>
                </div>
            </div>
        </div>
        <div class="row columns md:flex" style="display: none;">
            <div class="col-12 col-md-12 w-12/12">
                <h2>Schema</h2>
                <label for="schema-textarea">You can change the schema and see how the generated form looks. After you
                    make
                    changes, click "Update Schema"</label>
                <button class="btn btn-primary btn-block" id="setschema">Update Schema</button>
                <textarea id="schema-textarea" rows="30" style="width: 100%; font-family: monospace;"
                    class="form-control"></textarea>
            </div>
        </div>
    </div>
    <script>


        var defaultSchema =

       {"$schema":"http://json-schema.org/draft-07/schema#","$id":"https://fmgarage.com/schema/fxrp-xl-v2-2-2.json","title":"FX Reports Template Editor","description":"Generating xlsx spreadsheets from a json definition","$comment":"https://json-schema.org/understanding-json-schema/index.html","type":"object","properties":{"$comment":{"title":"Internal Comment","type":"string"},"schemaVersion":{"type":"string","title":"Schema Version","description":"Specify a minimum Schema Version","minLength":1,"pattern":"^\\d{1,3}(\\.\\d{1,3}(\\.\\d{1,3})?)?$"},"filename":{"title":"Target Filename","description":"Name of the generated file, placeholders are supported","type":"string","default":"Export.xslx"},"location":{"title":"Target Location","description":"folder path ('desktop/exports') or field reference (e.g. FxReports::a_container_[2])","default":"desktop/exports","type":"string"},"filters":{"type":"object","title":"Sheet Filters","description":"Sets a sheet filter","properties":{"autofilter":{"title":"Autofilter","description":"Toggle sheet auto filter","type":"boolean","default":true}},"additionalProperties":false},"formats":{"type":"object","title":"Definitions Formats","description":"Add named formats that can be referenced in columns, rows and cells","additionalProperties":{"$ref":"#/definitions/format"}},"fonts":{"type":"object","title":"Definitions Fonts","description":"Add Font definitions by specifying a unique Name. It is possible to extend other fontRefs.","additionalProperties":{"$ref":"#/definitions/font"}},"colors":{"type":"object","title":"Definitions Colors","description":"Add Color definitions by specifying a unique Name.","additionalProperties":{"type":"object","anyOf":[{"title":"as name","properties":{"name":{"$ref":"#/definitions/colorName"}},"required":["name"],"additionalProperties":false},{"title":"as RGB","properties":{"rgb":{"$ref":"#/definitions/colorRgb"}},"required":["rgb"],"additionalProperties":false}]}},"pictures":{"type":"object","title":"Definitions Pictures","description":"picture name as ref and path as field reference or file path","additionalProperties":{"title":"picture catalog item","description":"add picture to catalog by path or as base64","type":"object","anyOf":[{"title":"as path","properties":{"path":{"type":"string","format":"uri-reference","title":"path to image file","description":"system path, shortcuts are supported (e.g. 'desktop/logo.jpeg') or field reference (e.g. FxReports::a_container_[2])"}},"required":["path"],"additionalProperties":false},{"title":"as base64","properties":{"base64":{"type":"string","title":"base64 encoded","contentEncoding":"base64","contentMediaType":"image/png"}},"required":["base64"],"additionalProperties":false}]}},"formatRef":{"title":"Default Format Reference","description":"Will be applied to the workbook","$ref":"#/definitions/formatRef"},"format":{"title":"Default Format Options","description":"Will be applied to the workbook","$ref":"#/definitions/format"},"display":{"title":"Default Display Options","description":"Will be applied to the workbook","$ref":"#/definitions/display"},"print":{"title":"Default Print Options","$ref":"#/definitions/print"},"columnWidth":{"title":"Default Column Width","description":"Set default Column Width for all Sheets, use -1 for 'auto'","$ref":"#/definitions/columnWidth"},"columns":{"title":"Columns","$ref":"#/definitions/columns"},"rows":{"title":"Rows","$ref":"#/definitions/rows"},"cells":{"title":"Cells","$ref":"#/definitions/cells"},"name":{"title":"Sheet Name","$ref":"#/definitions/sheetName"},"split":{"title":"Sheet Freeze Panes","$comment":"deprecated","$ref":"#/definitions/freezePanes"},"sheets":{"title":"Multiple Sheets","$ref":"#/definitions/sheets"},"columnSeparator":{"title":"column separator in a text-file","default":";","type":"string"},"rowSeparator":{"title":"row separator in a text-file","default":"Â¶","type":"string"},"values":{"title":"Central Value Storage","description":"Values that can be referenced in the template.","type":"object","additionalProperties":{"anyOf":[{"title":"Row data array","description":"Row data array. Can contain arrays or objects.","type":"array","items":{"oneOf":[{"type":"array"},{"type":"object"}]}},{"title":"Scalar","description":"for cell data","type":["number","boolean","integer","null","string"]}]}}},"additionalProperties":false,"definitions":{"border":{"title":"Border style","description":"","anyOf":[{"title":"by ID","type":"integer","minimum":0,"maximum":13,"enum":[0,1,2,3,4,5,6,7,8,9,10,11,12,13],"default":1},{"title":"by Name","type":"string","enum":["none","thin","medium","dashed","dotted","thick","double","hair","medium dashed","dash dot","medium dash dot","dash dot dot","medium dash dot dot","slant dash dot"],"default":"thin"}]},"case":{"title":"Case-Statement","description":"conditional cell properties","anyOf":[{"$ref":"#/definitions/caseObject"},{"title":"multiple conditions OR","type":"array","minItems":1,"items":{"$ref":"#/definitions/caseObject"}}]},"caseObject":{"type":"object","title":"Condition","properties":{"if":{"$ref":"#/definitions/if"},"then":{"$ref":"#/definitions/thenOrElse"},"else":{"$ref":"#/definitions/thenOrElse"},"note":{"title":"internal note","$ref":"#/definitions/note"}},"required":["if","then"],"additionalProperties":false},"cell":{"type":"object","$comment":"when applying changes also apply at mirror cellInclude (without pos and case)","properties":{"pos":{"title":"Cell Position","description":"[col, row, col-length, row-length]. Default length is 1","type":"array","items":[{"type":"integer","title":"column start","minimum":0},{"type":"integer","title":"row start","minimum":0},{"type":"integer","title":"columns length","minimum":-1},{"type":"integer","title":"rows length","minimum":-1}],"minItems":2,"maxItems":4,"$comment":""},"formatRef":{"title":"Format Reference","$ref":"#/definitions/formatRef"},"format":{"title":"Format Options","$ref":"#/definitions/format"},"value":{"title":"Cell Content","$ref":"#/definitions/value"},"dataType":{"title":"Data Type","$ref":"#/definitions/dataType"},"valueRef":{"title":"Value reference","description":"Reference to central value storage.","type":"string"},"height":{"title":"Cell Height","description":"","type":"integer"},"width":{"title":"Cell Width","description":"","type":"integer"},"picture":{"title":"Picture","$ref":"#/definitions/picture"},"case":{"title":"Case-Statement","$ref":"#/definitions/case"},"note":{"title":"Internal Note","$ref":"#/definitions/note"}},"additionalProperties":false,"required":["pos"]},"cellInclude":{"type":"object","$comment":"should mirror cell without pos and case","properties":{"formatRef":{"title":"Format Reference","$ref":"#/definitions/formatRef"},"format":{"title":"Format Options","$ref":"#/definitions/format"},"value":{"title":"Value Type","$ref":"#/definitions/value"},"dataType":{"title":"Data Type","$ref":"#/definitions/dataType"},"valueRef":{"title":"Value reference","description":"Reference to central value storage.","type":"string"},"height":{"title":"Cell Height","description":"","type":"integer"},"width":{"title":"Cell Width","description":"","type":"integer"},"picture":{"title":"Picture","$ref":"#/definitions/picture"},"note":{"title":"Internal Note","$ref":"#/definitions/note"}},"additionalProperties":false},"cells":{"type":"array","minItems":1,"items":{"$ref":"#/definitions/cell"}},"color":{"type":"object","title":"color object","description":"contains color as name, ref or rgb","oneOf":[{"title":"by name","properties":{"name":{"$ref":"#/definitions/colorName"}},"required":["name"],"additionalProperties":false},{"title":"by reference","properties":{"ref":{"$ref":"#/definitions/colorRef"}},"required":["ref"],"additionalProperties":false},{"title":"by RGB values","properties":{"rgb":{"$ref":"#/definitions/colorRgb"}},"required":["rgb"],"additionalProperties":false}]},"colorName":{"type":"string","title":"Color Name","description":"Excel's predifined Colors","enum":["none","black","white","red","brightgreen","blue","yellow","pink","turquoise","darkred","green","darkblue","darkyellow","violet","teal","gray25","gray50","periwinkle cf","plum cf","ivory cf","lightturquoise cf","darkpurple cf","coral cf","oceanblue cf","iceblue cf","darkblue cl","pink cl","yellow cl","turquoise cl","violet cl","darkred cl","teal cl","blue cl","skyblue","lightturquoise","lightgreen","lightyellow","paleblue","rose","lavender","tan","lightblue","aqua","lime","gold","lightorange","orange","bluegray","gray40","darkteal","seagreen","darkgreen","olivegreen","brown","plum","indigo","gray80","default foreground","default background","tooltip","auto","Black","White","Red","Brightgreen","Blue","Yellow","Pink","Turquoise","Darkred","Green","Darkblue","Darkyellow","Violet","Teal","Gray25","Gray50","Periwinkle Cf","Plum Cf","Ivory Cf","Lightturquoise Cf","Darkpurple Cf","Coral Cf","Oceanblue Cf","Iceblue Cf","Darkblue Cl","Pink Cl","Yellow Cl","Turquoise Cl","Violet Cl","Darkred Cl","Teal Cl","Blue Cl","Skyblue","Lightturquoise","Lightgreen","Lightyellow","Paleblue","Rose","Lavender","Tan","Lightblue","Aqua","Lime","Gold","Lightorange","Orange","Bluegray","Gray40","Darkteal","Seagreen","Darkgreen","Olivegreen","Brown","Plum","Indigo","Gray80","Default Foreground","Default Background","Tooltip","Auto"]},"colorRef":{"type":"string","title":"Color Reference","description":"Name of Color Definition, must be defined in /colors","pattern":"^[a-zA-Z0-9-_]{2}","default":""},"colorRgb":{"type":"array","title":"Color RGB","description":"RGB values 0-255","minItems":3,"maxItems":3,"items":[{"title":"Red","type":"integer","minimum":0,"maximum":255,"default":255},{"title":"Green","type":"integer","minimum":0,"maximum":255,"default":255},{"title":"Blue","type":"integer","minimum":0,"maximum":255,"default":255}]},"column":{"title":"Column","type":"object","properties":{"pos":{"title":"Column Position","description":"Either Position or Range","anyOf":[{"type":"integer","minimum":-1},{"type":"array","description":"start index, length. -1 or undefined for auto.","minItems":1,"maxItems":2,"items":{"type":"integer","minimum":-1}}]},"type":{"description":"If dataType is set, this says where the format is applied.","type":"string","enum":["header","data","summary"],"default":"data"},"width":{"$ref":"#/definitions/columnWidth"},"formatRef":{"$ref":"#/definitions/formatRef"},"format":{"$ref":"#/definitions/format"},"dataType":{"$ref":"#/definitions/dataType"},"case":{"title":"Case-Statement","$ref":"#/definitions/case"}},"additionalProperties":false},"columnWidth":{"title":"Default Column Width","description":"Set default Column Width. Unit:character. Auto width:-1","type":"integer","minimum":-1,"default":-1},"columns":{"title":"Columns","type":"array","minItems":1,"items":{"title":"Column","$ref":"#/definitions/column"}},"dataType":{"title":"Data Type","type":"string","enum":["text","number","date","blank","timestamp","formula"]},"dateFormat":{},"display":{"title":"Display Options","type":"object","description":"can be applied to book or sheet","properties":{"hideGrid":{"title":"Hide Grid","type":"boolean","default":true},"zoom":{"title":"Zoom","type":"integer","minimum":25,"maximum":400,"default":150},"freeze":{"title":"Freeze panes","description":"Freeze panes at 0:1 (boolean) or individual x:y location (array)","$ref":"#/definitions/freezePanes"}},"additionalProperties":false},"font":{"type":"object","title":"Font Definition","description":"Create a font definition with font name and format options.","properties":{"fontRef":{"title":"Font Reference","$ref":"#/definitions/fontRef"},"fontColor":{"title":"Font Color","$ref":"#/definitions/color"},"fontName":{"type":"string","title":"Font Name","description":"Font face (e.g. 'Helvetica'"},"fontSize":{"title":"Font Size","desciption":"","type":"integer","minimum":1,"default":13},"bold":{"title":"Bold","type":"boolean"},"italic":{"title":"Text is Italic","type":"boolean"},"underline":{"title":"Text Underline","description":"Sets the underline style of the font. 0 no underline, 1 single, 2 double, 33 acc single, 34 acc double","type":"integer","enum":[0, 1, 2, 33, 34]},"note":{"title":"internal note","$ref":"#/definitions/note"}},"additionalProperties":false},"fontRef":{"type":"string","title":"Font Reference","description":"Name of a Font Definition"},"format":{"type":"object","title":"Format Options","description":"","properties":{"formatRef":{"title":"Format Reference","description":"Use an existing Format Definition to apply Changes to.","$ref":"#/definitions/formatRef"},"dataType":{"title":"Cell Data Type","type":"string","description":"Data Type of the Excel Cell","enum":["text","number","date","blank","timestamp","formula"]},"lock":{"title":"Cell Lock","description":"(not implemented) lock cell for editing","type":"boolean"},"hide":{"title":"Cell Hide","type":"boolean","options":{"hidden":true}},"shrinkToFit":{"title":"Cell Shrink to Fit","type":"boolean"},"fontRef":{"title":"Font Reference","$ref":"#/definitions/fontRef"},"fontName":{"title":"Font Name","description":"Font face name (e.g. 'Helvetica')","type":"string"},"fontSize":{"title":"Font Size","desciption":"Font Size in pt","type":"integer","minimum":1},"fontColor":{"title":"Font Color","$ref":"#/definitions/color"},"bold":{"title":"Text is Bold","type":"boolean"},"italic":{"title":"Text is Italic","type":"boolean"},"underline":{"title":"Text Underline","description":"Sets the underline style of the font. 0 no underline, 1 single, 2 double, 33 acc single, 34 acc double","type":"integer","enum":[0, 1, 2, 33, 34]},"alignH":{"title":"Text Horizontal Alignment","description":"Alignment of Text in Cell:0 general, 1 left, 2 center, 3 right, 4 full, 5 justify, 6 merge, 7 distributed","type":"integer","enum":[0, 1, 2, 3, 4, 5, 6, 7]},"alignV":{"title":"Text Vertical Alignment","description":"Alignment of Text in Cell, 0 top, 1 center, 2 bottom, 3 justify, 4 distributed","type":"integer","enum":[0, 1, 2, 3, 4]},"wrap":{"title":"Text Wrap","type":"boolean","description":""},"indent":{"title":"Text Indentation","type":"integer","description":"(not implemented)"},"rotate":{"title":"Text Rotate","type":"integer","description":"(not implemented) Rotate Text by value from 0 to 255","minimum":0,"maximum":255},"numberFormat":{"title":"Number Format Reference","$ref":"#/definitions/numberFormat"},"numberFormatCustom":{"title":"Number Format Custom","$ref":"#/definitions/numberFormatCustom"},"border":{"title":"Border:Style","description":"set the style for all 4 borders","$ref":"#/definitions/border"},"borderColor":{"title":"Border:Color","$ref":"#/definitions/color"},"borderTop":{"title":"Border Top:Style","$ref":"#/definitions/border"},"borderTopColor":{"title":"Border Top:Color","$ref":"#/definitions/color"},"borderRight":{"title":"Border Right:Style","$ref":"#/definitions/border"},"borderRightColor":{"title":"Border Right:Color","$ref":"#/definitions/color"},"borderBottom":{"title":"Border Bottom:Style","$ref":"#/definitions/border"},"borderBottomColor":{"title":"Border Bottom:Color","$ref":"#/definitions/color"},"borderLeft":{"title":"Border Left:Style","$ref":"#/definitions/border"},"borderLeftColor":{"title":"Border Left:Color","$ref":"#/definitions/color"},"borderDiagonal":{"title":"Border Diagonal:Style","$ref":"#/definitions/border"},"borderDiagonalMode":{"title":"Border Diagonal:Mode","type":"string","enum":["none","up","down","both"]},"borderDiagonalColor":{"title":"Border Diagonal:Color","$ref":"#/definitions/color"},"pattern":{"title":"Background Pattern","anyOf":[{"type":"string","enum":["none","solid","50% gray","75% gray","25% gray","horizontal stripes","vertical stripes","reverse diagonal stripes","diagonal stripes","diagonal cross hatch","thick diagonal stripe","thin horizontal stripe","thin vertical stripe","thin reverse diagonal stripe","thin diagonal stripe","thin horizontal cross hatch","thin diagonal cross hatch","gray 12p5","gray 6p25"]},{"type":"integer","minimum":0,"maximum":18,"description":"see:https://www.mbsplugins.eu/XLFormatSetFillPattern.shtml"}]},"backgroundColor":{"title":"Background Color","$ref":"#/definitions/color"},"foregroundColor":{"title":"Foreground Color","$ref":"#/definitions/color"},"note":{"title":"internal note","$ref":"#/definitions/note"}},"additionalProperties":false},"formatRef":{"type":"string","title":"Format Reference","description":"Name of a defined Format"},"headerOrFooter":{"type":"object","title":"Definition of header or footer","properties":{"margin":{"title":"Margin","description":"Margin from header or footer cell to the outer bounds of paper. The unit is inches.","type":"number","minimum":0},"left":{"$ref":"#/definitions/headerOrFooterSection"},"center":{"$ref":"#/definitions/headerOrFooterSection"},"right":{"$ref":"#/definitions/headerOrFooterSection"}}},"headerOrFooterSection":{"type":"object","anyOf":[{"title":"with Font as Reference","properties":{"text":{"type":"string","title":"Text","description":"Placeholders:{page}{total}{date}{time}{picture}{filepath}{filename}{sheet}, format tags (start/stop):{strike}{sup}{sub}{underline}{underlines}{b}{i}"},"fontRef":{"title":"Font Reference","$ref":"#/definitions/fontRef"}},"additionalProperties":false,"required":["text"]},{"title":"with Font as Definition","properties":{"fontName":{"type":"string","title":"Font Name","description":"Font face (e.g. 'Helvetica')"},"fontSize":{"type":"integer","minimum":1,"default":1,"title":"Font Size","desciption":"Font Size in point"},"bold":{"title":"Bold","type":"boolean"},"italic":{"title":"Italic","type":"boolean"},"text":{"type":"string","title":"Text","description":"Placeholders:{page}{total}{date}{time}{picture}{filepath}{filename}{sheet}. format tags (start/stop):{strike}{sup}{sub}{underline}{underlines}{b}{i}"}},"additionalProperties":false,"required":["text"]}]},"if":{"type":"object","title":"If Condition","description":"","properties":{"value":{"type":"object","title":"Value","description":"Object holding ONE condition rule.","oneOf":[{"title":"equalTo","properties":{"equalTo":{"type":["string","number"]}},"additionalProperties":false,"required":["equalTo"]},{"title":"beginsWith","properties":{"beginsWith":{"type":"string"}},"additionalProperties":false,"required":["beginsWith"]},{"title":"endsWith","properties":{"endsWith":{"type":"string"}},"additionalProperties":false,"required":["endsWith"]},{"title":"contains","properties":{"contains":{"type":"string"}},"additionalProperties":false,"required":["contains"]},{"title":"containsAny","properties":{"containsAny":{"type":"array","items":{"type":"string"}}},"additionalProperties":false,"required":["containsAny"]},{"title":"containsAll","properties":{"containsAll":{"type":"array","items":{"type":"string"}}},"additionalProperties":false,"required":["containsAll"]},{"title":"greaterThan","properties":{"greaterThan":{"type":"number"}},"additionalProperties":false,"required":["greaterThan"]},{"title":"greaterThanOrEqualTo","properties":{"greaterThanOrEqualTo":{"type":"number"}},"additionalProperties":false,"required":["greaterThanOrEqualTo"]},{"title":"lessThan","properties":{"lessThan":{"type":"number"}},"additionalProperties":false,"required":["lessThan"]},{"title":"lessThanOrEqualTo","properties":{"lessThanOrEqualTo":{"type":"number"}},"additionalProperties":false,"required":["lessThanOrEqualTo"]}]}},"required":["value"],"additionalProperties":false},"margin":{"title":"Margins of the sheet","description":"Margins of the sheet. The unit is inches.","type":"number","minimum":0},"note":{"title":"internal note","type":"string"},"numberFormat":{"title":"Number Format","description":"individual format options for numbers, dates, currencies, see https://www.mbsplugins.eu/XLFormatSetNumFormat.shtml","anyOf":[{"type":"string","enum":["general","number","number_d2"],"$comment":"@todo:parametrisieren, url:https://www.mbsplugins.eu/XLFormatSetNumFormat.shtml"},{"type":"integer","minimum":0,"maxValue":49}]},"numberFormatCustom":{"title":"Custom Number Format","description":"custom format options for numbers, dates, currencies..., check https://www.mbsplugins.eu/XLBookAddCustomNumFormat.shtml","type":"string"},"picture":{"type":"object","title":"Picture","anyOf":[{"title":"as reference","properties":{"ref":{"title":"reference","description":"named picture from catalog","type":"string"},"width":{"$ref":"#/definitions/pictureWidth"},"height":{"$ref":"#/definitions/pictureHeight"},"scale":{"$ref":"#/definitions/pictureScale"},"x":{"$ref":"#/definitions/pictureX"},"y":{"$ref":"#/definitions/pictureY"},"position":{"$ref":"#/definitions/picturePosition"},"note":{"title":"internal note","$ref":"#/definitions/note"}},"additionalProperties":false,"required":["ref"]},{"title":"as path","properties":{"path":{"type":"string","format":"uri-reference","title":"path to image file","description":"system path, shortcuts are supported (e.g. 'desktop/logo.jpeg')"},"width":{"$ref":"#/definitions/pictureWidth"},"height":{"$ref":"#/definitions/pictureHeight"},"scale":{"$ref":"#/definitions/pictureScale"},"x":{"$ref":"#/definitions/pictureX"},"y":{"$ref":"#/definitions/pictureY"},"position":{"$ref":"#/definitions/picturePosition"},"note":{"title":"internal note","$ref":"#/definitions/note"}},"additionalProperties":false,"required":["path"]},{"title":"as base64","properties":{"base64":{"type":"string","contentEncoding":"base64","contentMediaType":"image/png"},"width":{"$ref":"#/definitions/pictureWidth"},"height":{"$ref":"#/definitions/pictureHeight"},"scale":{"$ref":"#/definitions/pictureScale"},"x":{"$ref":"#/definitions/pictureX"},"y":{"$ref":"#/definitions/pictureY"},"position":{"$ref":"#/definitions/picturePosition"},"note":{"title":"internal note","$ref":"#/definitions/note"}},"additionalProperties":false,"required":["base64"]}]},"pictureWidth":{"type":"integer","title":"image width","description":"pixels, can be -1 or non-defined for auto"},"pictureHeight":{"type":"integer","title":"image height","description":"pixels, can be -1 or non-defined for auto"},"pictureScale":{"title":"Scale factor of picture","description":"(not recommended) You can either use scale or width and height. Default ist 1.0","type":"number","exclusiveMinimum":0,"maximum":1},"pictureX":{"type":"integer","title":"Relative offset from left in pixels"},"pictureY":{"type":"integer","title":"relative offset from top in pixels"},"picturePosition":{"type":"string","titel":"positioning of the image","enum":["resize","move","fix"],"description":"resize:move&resize, move:only move, fix:position is absolute"},"print":{"title":"Default Print Options","description":"Option defining the print settings.","type":"object","properties":{"fit":{"title":"Fit to Page","description":"Fit sheet to page(s) in width and height when printed. [ pages width, pages height]","type":"array","minItems":1,"maxItems":2,"items":{"type":"integer","minimum":0}},"footer":{"$ref":"#/definitions/headerOrFooter","title":"Footer","description":"set up a Footer"},"header":{"$ref":"#/definitions/headerOrFooter","title":"Header","description":"Set up a header."},"landscape":{"title":"Landscape Orientation","type":"boolean"},"marginBottom":{"$ref":"#/definitions/margin","title":"bottom margin of the sheet"},"marginLeft":{"$ref":"#/definitions/margin","title":"left margin of the sheet"},"marginRight":{"$ref":"#/definitions/margin","title":"right margin of the sheet"},"marginTop":{"$ref":"#/definitions/margin","title":"top margin of the sheet"},"paperSize":{"title":"Paper size","anyOf":[{"type":"string","title":"by Name","description":"Set paper size by name, 'default' depends on the machine the template is processed on, this could also be different on server","enum":["DEFAULT","LETTER","LETTERSMALL","TABLOID","LEDGER","LEGAL","STATEMENT","EXECUTIVE","A3","A4","A4SMALL","A5","B4","B5","FOLIO","QUATRO","10x14","10x17","NOTE","ENVELOPE_9","ENVELOPE_10","ENVELOPE_11","ENVELOPE_12","ENVELOPE_14","C_SIZE","D_SIZE","E_SIZE","ENVELOPE_DL","ENVELOPE_C5","ENVELOPE_C3","ENVELOPE_C4","ENVELOPE_C6","ENVELOPE_C65","ENVELOPE_B4","ENVELOPE_B5","ENVELOPE_B6","ENVELOPE","ENVELOPE_MONARCH","US_ENVELOPE","FANFOLD","GERMAN_STD_FANFOLD","GERMAN_LEGAL_FANFOLD"]},{"type":"integer","title":"as Integer","description":"default:0, Letter:1, A4:9 (see documentation or use the 'by name' option","minimum":0,"maximum":41,"default":0}]},"repeatRows":{"title":"Repeat rows","description":"Repeat these row(s) as header after each pagebreak.","anyOf":[{"type":"integer","title":"Single row","minimum":0,"default":0},{"type":"array","title":"Multiple rows","description":"Set first row (starting with 0) and count of rows to repeat.","minItems":2,"maxItems":2,"items":[{"type":"integer","title":"Start row","minimum":0},{"type":"integer","title":"Row count","minimum":1,"default":1}]}]},"withGrid":{"title":"Print Grid","description":"Include cell grid when printing.","type":"boolean"},"note":{"title":"internal note","$ref":"#/definitions/note"}},"additionalProperties":false},"row":{"type":"object","title":"Row","description":"Row is added after the previous one if not defined otherwise using 'Position'","properties":{"type":{"type":"string","title":"Row Type","description":"Rows can be of type 'header', 'data' or 'summary'. Choosing one applies specific formattings.","$comment":"these values trigger formats defined by fx-reports","enum":["header","data","summary"]},"dataType":{"$ref":"#/definitions/dataType"},"pos":{"title":"Position","description":"Absolute Position (integer) or Position and Length (array)","anyOf":[{"type":"integer","description":"Position of row. First row has pos 0","minimum":0},{"type":"array","description":"[x,y]:x - optional column offset, y - position of row. First column/row has pos 0","minItems":2,"maxItems":2,"items":{"type":"integer","minimum":0}}]},"formatRef":{"title":"Format Reference","$ref":"#/definitions/formatRef"},"format":{"title":"Format Details","description":"Define a format from scratch or modify a referenced format","$ref":"#/definitions/format"},"values":{"title":"Values","description":"Add one row (array of values) or multiple rows (array of arrays|rows)","type":"array","minItems":1,"anyOf":[{"title":"as single row","items":{"$ref":"#/definitions/value"}},{"title":"as multiple rows","items":{"type":"array","items":{"$ref":"#/definitions/value"}}}]},"valuesRef":{"title":"Value reference","description":"reference to central value storage","type":"string","pattern":"^[a-zA-Z0-9\\/]+$"},"path":{"title":"Data Source Path","description":"Path to a source excel file. Located in the filesystem or in a container field.","type":"string","default":"FxReports::a_container_[2]"},"includeFirstRow":{"title":"Include first row","description":"Include the first row of the source file, normally contains columns headers","type":"boolean","default":true},"limit":{"title":"Data Source Limit","description":"Limit Rows from Data Source","type":"integer","minimum":0},"offset":{"title":"Data Source Offset","description":"Specify Data File Row to begin with","type":"integer","minimum":0},"contentType":{"title":"Data Source Type","description":"Content Type in Source File or Field","type":"string","enum":["json","csv","tab"],"default":"json"},"fields":{"title":"Data Source Filter","description":"Determines which fields from the source shall be in the target file. References the header names.","type":"array","items":{"type":"string"},"minItems":1},"height":{"title":"Row Height","description":"Set the Row Height in points.","type":"integer"},"widths":{"title":"Column Widths","description":"Specify Columns Widths, use -1 for 'auto'. The unit is `character`. To specify the width for all columns, set Default Column Width in sheet or workbook","type":"array","minItems":1,"items":{"type":"integer","minimum":-1,"default":-1}},"note":{"title":"internal note","options":{"hidden":true},"$ref":"#/definitions/note"}},"additionalProperties":false},"rows":{"title":"Rows","description":"Array of Rows, starting from top if not specified by Position.\rData Rows are repeated regarding to their input.","type":"array","minItems":1,"items":{"$ref":"#/definitions/row"}},"sheet":{"title":"Sheet","description":"Content and Structure of an Excel Sheet. 'Columns', 'Rows' and 'Cells' will be processed in this very order","type":"object","properties":{"name":{"title":"Sheet Name","$ref":"#/definitions/sheetName"},"formatRef":{"title":"Default Format Reference","description":"Set Default Format for Sheet","$ref":"#/definitions/formatRef"},"format":{"title":"Format Details","$ref":"#/definitions/format"},"display":{"title":"Display Options","$ref":"#/definitions/display"},"print":{"title":"Print Options","$ref":"#/definitions/print"},"split":{"$comment":"deprecated","$ref":"#/definitions/freezePanes"},"columnWidth":{"title":"Default Column Width","description":"Set the default width for all columns in the worksheet, use -1 for auto","$ref":"#/definitions/columnWidth"},"columns":{"title":"Columns","$ref":"#/definitions/columns"},"rows":{"title":"Rows","$ref":"#/definitions/rows"},"cells":{"title":"Cells","$ref":"#/definitions/cells"},"filters":{"type":"object","title":"Sheet Filters","description":"Sets sheet filter","properties":{"autofilter":{"title":"Autofilter","description":"Sets sheet auto filter","type":"boolean","default":true}},"additionalProperties":false},"defaultColumn":{"type":"object","properties":{"width":{"type":"integer","description":"unit:character","minimum":-1},"minWidth":{"type":"integer","description":"unit:character","minimum":1},"maxWidth":{"type":"integer","description":"unit:character","minimum":1}},"additionalProperties":false},"note":{"title":"internal note","$ref":"#/definitions/note"}},"additionalProperties":false},"sheetName":{"type":"string","title":"Sheet Name","description":"Optional sheet name","default":"Sheet1"},"sheets":{"type":"array","title":"Multiple Sheets","description":"This array can be used if more than one sheet is defined","minItems":1,"items":{"$ref":"#/definitions/sheet"}},"freezePanes":{"title":"Freeze panes","description":"Freeze panes at [0, 1] (boolean) or at individual [column, row] position (array)","anyOf":[{"title":"Freeze first row","type":"boolean","description":"Freeze default pane (first row)"},{"title":"Freeze at custom position","type":"array","minItems":2,"maxItems":2,"description":"[column, row]","items":[{"title":"column","type":"integer","default":0},{"title":"row","type":"integer","default":1}]}]},"thenOrElse":{"title":"Case result","description":"Cell properties and values.","type":"object","$ref":"#/definitions/cellInclude"},"value":{"title":"Value Type","type":["string","number","boolean","null"],"default":""}}}

        // parse url -> merge options -> refreshUI() -> initJsoneditor() -> direct link

        /* ------------------------------------------------------------------- data */

        var data = {}

        var defaultOptions = {
            iconlib: 'fontawesome5',
            display_required_only: true,
            object_layout: 'normal',
            schema: defaultSchema,
            show_errors: 'interaction',
            theme: 'bootstrap4'
        }

        var jsoneditor = null
        var directLink = document.querySelector('#direct-link')

        var booleanOptionsSelect = document.querySelector('#boolean-options-select')
        var head = document.getElementsByTagName('head')[0]
        var iconlibSelect = document.querySelector('#iconlib-select')
        var iconlibLink = document.querySelector('#iconlib-link')
        var libSelect = document.querySelector('#lib-select')
        var jsonEditorForm = document.querySelector('#json-editor-form')
        var objectLayoutSelect = document.querySelector('#object-layout-select')
        var outputTextarea = document.querySelector('#output-textarea')
        var schemaTextarea = document.querySelector('#schema-textarea')
        var setSchema = document.querySelector('#setschema')
        var setValue = document.querySelector('#setvalue')
        var getValue = document.querySelector('#getvalue')
        var showErrorsSelect = document.querySelector('#show-errors-select')
        var themeSelect = document.querySelector('#theme-select')
        var themeLink = document.querySelector('#theme-link')
        var validateTextarea = document.querySelector('#validate-textarea')

        /* -------------------------------------------------------------- parse url */

        var parseUrl = function () {
            var url = window.location.search
            var queryParamsString = url.substring(1, url.length)
            var queryParams = queryParamsString.split('&')

            if (queryParamsString.length) {
                queryParams.forEach(function (queryParam) {
                    var splittedParam = queryParam.split('=')
                    var param = splittedParam[0]
                    var value = splittedParam[1]

                    // data query param
                    if (param === 'data') {
                        // compress schema and value
                        try {
                            data = JSON.parse(LZString.decompressFromBase64(value))
                        } catch (reason) {
                        }
                    }
                })
            }

            mergeOptions()
        }

        /* ----------------------------------------------------------- mergeOptions */

        var mergeOptions = function () {
            data.options = Object.assign(defaultOptions, data.options)
            refreshUI()
        }

        /* -------------------------------------------------------------- refreshUI */

        var refreshUI = function () {
            // schema
            schemaTextarea.value = JSON.stringify(data.options.schema, null, 2)

            // boolean values
            var booleanOptions = booleanOptionsSelect.children
            for (var i = 0; i < booleanOptions.length; i++) {
                var booleanValue = booleanOptions[i]
                if (data.options[booleanValue.value]) {
                    booleanValue.selected = true
                }
            }

            // libs
            var libMapping = {
                ace_editor: {
                    js: [
                        'https://cdn.jsdelivr.net/npm/ace-editor-builds@1.2.4/src-min-noconflict/ace.js'
                    ],
                    css: []
                },
                choices: {
                    js: [
                        'https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js'
                    ],
                    css: [
                        'https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css'
                    ]
                },
                cleavejs: {
                    js: [
                        'https://cdn.jsdelivr.net/npm/cleave.js@1.4.7/dist/cleave.min.js'
                    ],
                    css: []
                },
                sceditor: {
                    js: [
                        'https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js',
                        'https://cdn.jsdelivr.net/npm/sceditor@2.1.3/minified/sceditor.min.js',
                        'https://cdn.jsdelivr.net/npm/sceditor@2.1.3/minified/formats/bbcode.js',
                        'https://cdn.jsdelivr.net/npm/sceditor@2.1.3/minified/formats/xhtml.js'
                    ],
                    css: [
                        'https://cdn.jsdelivr.net/npm/sceditor@2.1.3/minified/themes/default.min.css'
                    ]
                },
                simplemde: {
                    js: [
                        'https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.js'
                    ],
                    css: [
                        'https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.css'
                    ]
                },
                select2: {
                    js: [
                        'https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js',
                        'https://cdn.jsdelivr.net/npm/select2@4.0.6-rc.1/dist/js/select2.min.js'
                    ],
                    css: [
                        'https://cdn.jsdelivr.net/npm/select2@4.0.6-rc.1/dist/css/select2.min.css'
                    ]
                },
                selectize: {
                    js: [
                        'https://cdn.jsdelivr.net/npm/selectize@0.12.6/dist/js/standalone/selectize.min.js'
                    ],
                    css: [
                        'https://cdn.jsdelivr.net/npm/selectize@0.12.6/dist/css/selectize.min.css',
                        'https://cdn.jsdelivr.net/npm/selectize@0.12.6/dist/css/selectize.default.min.css'
                    ]
                },
                flatpickr: {
                    js: [
                        'https://cdn.jsdelivr.net/npm/flatpickr'
                    ],
                    css: [
                        'https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css'
                    ]
                },
                signature_pad: {
                    js: [
                        'https://cdn.jsdelivr.net/npm/signature_pad@2.3.2/dist/signature_pad.min.js'
                    ],
                    css: []
                },
                mathjs: {
                    js: [
                        'https://cdn.jsdelivr.net/npm/mathjs@5.3.1/dist/math.min.js'
                    ],
                    css: []
                },
            }

            if (data.selectedLibs || data.unselectedLibs) {

                var booleanOptions = booleanOptionsSelect.children
                for (var i = 0; i < booleanOptions.length; i++) {
                    var booleanValue = booleanOptions[i]
                    if (data.options[booleanValue.value]) {
                        booleanValue.selected = true
                    }
                }

                var libSelectChildren = libSelect.children
                for (var i = 0; i < libSelectChildren.length; i++) {
                    var child = libSelectChildren[i]
                    child.selected = data.selectedLibs.includes(child.value)
                }

                // remove libraries
                data.unselectedLibs.forEach(function (selectedLib) {
                    var concat = libMapping[selectedLib].js.concat(libMapping[selectedLib].css)
                    concat.forEach(function () {
                        var className = '.external_' + selectedLib
                        var toRemove = head.querySelector(className)
                        if (toRemove) {
                            toRemove.parentNode.removeChild(toRemove)
                        }
                    })
                })

                // add libraries
                data.selectedLibs.forEach(function (selectedLib) {
                    // add js
                    libMapping[selectedLib].js.forEach(function (js) {
                        var scriptElement = document.createElement('script')
                        scriptElement.type = 'text/javascript'
                        scriptElement.src = js
                        scriptElement.async = false
                        scriptElement.classList.add('external_' + selectedLib)
                        head.appendChild(scriptElement)
                    })
                    // add css
                    libMapping[selectedLib].css.forEach(function (css) {
                        var linkElement = document.createElement('link')
                        linkElement.setAttribute('rel', 'stylesheet')
                        linkElement.setAttribute('type', 'text/css')
                        linkElement.setAttribute('href', css)
                        linkElement.classList.add('external_' + selectedLib)
                        head.appendChild(linkElement)
                    })
                })
            }

            initJsoneditor()
        }

        /* --------------------------------------------------------- initJsoneditor */

        var initJsoneditor = function () {
            // destroy old JSONEditor instance if exists
            if (jsoneditor) {
                jsoneditor.destroy()
            }

            // new instance of JSONEditor
            jsoneditor = new window.JSONEditor(jsonEditorForm, data.options)

            // listen for changes
            jsoneditor.on('change', function () {
                // output
                var json = jsoneditor.getValue()
                outputTextarea.value = JSON.stringify(json, null, 2)
                }
            )

        }

        /* ------------------------------------------------------- updateDirectLink */


        /* -------------------------------------------------------- event listeners */

        setValue.addEventListener('click', function () {
            jsoneditor.setValue(JSON.parse(outputTextarea.value))
        })

        setSchema.addEventListener('click', function () {
            try {
                data.options.schema = JSON.parse(schemaTextarea.value)
            } catch (e) {
                alert('Invalid Schema: ' + e.message)
                return
            }
            refreshUI()
        })

        parseUrl()
    </script>


</body>

</html>